@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        /* 主要背景 - 深蓝黑 */
        --bg-primary: 240 25% 4%;
        /* 次要背景 */
        --bg-secondary: 240 20% 10%;
        /* 面板背景 */
        --bg-panel: 240 15% 16%;

        /* 字体定义 */
        --font-sans: "Space Grotesk", "Noto Sans SC", "PingFang SC", -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif;
        --font-mono: "JetBrains Mono", "Fira Code", "Cascadia Code", "Roboto Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

        /* 科技蓝主题色 */
        --primary: 230 70% 65%;
        --primary-foreground: 0 0% 100%;

        /* 强调色 */
        --accent: 230 70% 65%;
        --accent-foreground: 0 0% 100%;

        /* 成功色 */
        --success: 160 65% 45%;
        --success-foreground: 0 0% 100%;

        /* 警告色 */
        --warning: 35 90% 60%;
        --warning-foreground: 0 0% 100%;

        /* 错误色 */
        --destructive: 0 70% 55%;
        --destructive-foreground: 0 0% 100%;

        /* 背景色 */
        --background: var(--bg-primary);
        --foreground: 240 10% 90%;

        --card: var(--bg-panel);
        --card-foreground: var(--foreground);

        --popover: var(--bg-panel);
        --popover-foreground: var(--foreground);

        /* 边框和分割线 */
        --border: 240 10% 25%;
        --input: 240 10% 30%;

        /* 辅助色 */
        --secondary: var(--bg-secondary);
        --secondary-foreground: var(--foreground);

        --muted: 240 10% 20%;
        --muted-foreground: 240 5% 60%;

        --ring: var(--primary);

        --radius: 0.5rem;
    }

    * {
        @apply border-border;
    }

    body {
        font-family: var(--font-sans);
        @apply min-h-screen bg-background text-foreground antialiased text-base leading-relaxed;
        background-image:
            radial-gradient(circle at 1% 10%, hsl(var(--primary) / 0.03) 0%, transparent 30%),
            radial-gradient(circle at 99% 90%, hsl(var(--accent) / 0.03) 0%, transparent 30%),
            linear-gradient(to bottom, hsl(var(--background)), hsl(var(--background)));
        background-attachment: fixed;
    }

    /* 自定义滚动条 */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        background: hsl(var(--muted));
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
        background: hsl(var(--muted-foreground) / 0.5);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: hsl(var(--muted-foreground) / 0.7);
    }
}

/* Table readability */
.handsontable td,
.handsontable th {
    padding: 0.5rem 0.75rem !important;
    line-height: 1.5 !important;
    font-size: 0.95rem !important;
    border-color: hsl(var(--border)) !important;
}

.handsontable td {
    background-color: hsl(var(--card)) !important;
    color: hsl(var(--foreground)) !important;
    transition: background-color 0.12s ease, color 0.12s ease;
}

.handsontable td:hover {
    background-color: hsl(var(--card) / 0.8) !important;
}

.handsontable th {
    background-color: hsl(var(--muted)) !important;
    color: hsl(var(--muted-foreground)) !important;
    font-weight: 600 !important;
}

.handsontable td.current,
.handsontable th.current {
    background-color: hsl(var(--primary) / 0.18) !important;
    color: hsl(var(--foreground)) !important;
    font-weight: 600 !important;
}

.handsontable td.area {
    background-color: hsl(var(--primary) / 0.08) !important;
}

.handsontable .wtBorder {
    background-color: hsl(var(--primary)) !important;
    border-color: hsl(var(--primary)) !important;
}

.handsontable .wtBorder.corner {
    border-color: hsl(var(--primary)) !important;
    background-color: hsl(var(--primary)) !important;
    box-shadow: 0 0 0 1px hsl(var(--primary)) !important;
}

.handsontable .handsontableInput {
    font-family: var(--font-sans);
    font-size: 0.95rem;
    color: hsl(var(--foreground));
}

.handsontable .htCore col {
    border-color: hsl(var(--border));
}

.handsontable .htDimmed {
    color: hsl(var(--muted-foreground)) !important;
    background-color: hsl(var(--muted) / 0.6) !important;
}

.handsontable .htOrderCell {
    padding: 0 !important;
}

.handsontable .htOrderCellInner {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.2rem;
    width: 100%;
    padding: 0.25rem 0.35rem;
}

.handsontable .htOrderValue {
    font-weight: 600;
}

.handsontable .htOrderWarningIcon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1rem;
    height: 1rem;
    border-radius: 9999px;
    background-color: hsl(var(--destructive) / 0.9);
    color: hsl(var(--destructive-foreground));
    font-size: 0.75rem;
    line-height: 1;
    cursor: help;
}

/* Fix: ensure HOT dropdown/autocomplete editors render above grid cells */
.handsontable.autocompleteEditor,
.handsontable .htSelectEditor {
    position: absolute !important;
    z-index: 1060 !important; /* above clones and cells; similar to context menu */
}
.handsontable.autocompleteEditor {
    margin-top: 2px;
}
.handsontable.autocompleteEditor {
    min-height: 112px;
}
.handsontable.autocompleteEditor .wtHolder {
    min-height: 112px;
    max-height: 280px;
    overflow: auto;
}
.handsontable .htSelectEditor select {
    position: absolute !important;
    z-index: 1061 !important;
}
